"0",""
"0","# create a df where the missing income blocks are removed for easier analysis. This takes ou 8 blocks"
"0","cook.cnty.sub <- cook.cnty[! is.na(cook.cnty$Median_HHIncome), ]"
"0",""
"0","# classify community areas into percentiles by mean hhincome***********************"
"0",""
"0","z <- cook.cnty.sub %>% group_by(community) %>% summarize(avg_mhhi = round(mean(Median_HHIncome)))"
"0",""
"0","cmnty_income_deciles <- quantile(z$avg_mhhi, probs = c(.10, .2, .3, .4, .5, .6, .7, .8, .9), names=F)"
"0",""
"0","z <- z %>% mutate(cmnty_inc_deciles = ifelse(avg_mhhi < cmnty_income_deciles[1], ""Perc_10th"","
"0","                                        ifelse(avg_mhhi < cmnty_income_deciles[2], ""Perc_20th"","
"0","                                               ifelse(avg_mhhi < cmnty_income_deciles[3], ""Perc_30th"","
"0","                                                      ifelse(avg_mhhi < cmnty_income_deciles[4], ""Perc_40th"","
"0","                                                             ifelse(avg_mhhi < cmnty_income_deciles[5], ""Perc_50th"","
"0","                                                                    ifelse(avg_mhhi < cmnty_income_deciles[6], ""Perc_60th"","
"0","                                                                           ifelse(avg_mhhi < cmnty_income_deciles[7], ""Perc_70th"","
"0","                                                                                  ifelse(avg_mhhi < cmnty_income_deciles[8], ""Perc_80th"","
"0","                                                                                         ifelse(avg_mhhi < cmnty_income_deciles[9], ""Perc_90th"", ""Top""))))))))) )"
"0",""
"0",""
"0","cook.cnty.sub <- cook.cnty.sub %>% left_join( st_set_geometry(z, NULL), by= ""community"")"
"0",""
"0","#*****************************************"
"0",""
"0","# Classify block grps into income deciles ***********************"
"0",""
"0","bg_income_deciles <- quantile(cook.cnty.sub$Median_HHIncome, probs = c(.10, .2, .3, .4, .5, .6, .7, .8, .9), names=F)"
"0",""
"0","cook.cnty.sub <- cook.cnty.sub %>% mutate(bg_inc_deciles = ifelse(Median_HHIncome < bg_income_deciles[1], ""Perc_10th"","
"0","                                        ifelse(Median_HHIncome < bg_income_deciles[2], ""Perc_20th"","
"0","                                               ifelse(Median_HHIncome < bg_income_deciles[3], ""Perc_30th"","
"0","                                                      ifelse(Median_HHIncome < bg_income_deciles[4], ""Perc_40th"","
"0","                                                             ifelse(Median_HHIncome < bg_income_deciles[5], ""Perc_50th"","
"0","                                                                    ifelse(Median_HHIncome < bg_income_deciles[6], ""Perc_60th"","
"0","                                                                           ifelse(Median_HHIncome < bg_income_deciles[7], ""Perc_70th"","
"0","                                                                                  ifelse(Median_HHIncome < bg_income_deciles[8], ""Perc_80th"","
"0","                                                                                         ifelse(Median_HHIncome < bg_income_deciles[9], ""Perc_90th"", ""Top""))))))))) ) "
"0",""
"0","#*********************************"
"0",""
"0",""
"0","#reorder community by mean hhincome"
"0","bymean <- with(cook.cnty.sub, reorder(community, Median_HHIncome, mean))"
"0",""
"0",""
"0",""
"0","#plots**************************"
"0",""
"0",""
"0","# by adding the community colors to this plot, we can see that communities are made of blocks that fall into "
"0","# different percentiles"
"0","ggplot(cook.cnty.sub, aes(bymean, Median_HHIncome,fill = cook.cnty.sub$cmnty_inc_deciles)) + geom_boxplot() +"
"0","  theme(axis.text.x = element_text(angle = 90, hjust = 1, size=6)) + ggtitle(""Distribution of Median HHIncome Within Community Area"") + xlab(""Community Area"") + theme(legend.position=""bottom"") + scale_fill_brewer(palette = ""RdYlGn"")"
